{"version":3,"sources":["App.js","serviceWorker.js","index.js"],"names":["colormap","require","interpolate","naturalsUpTo","n","Array","keys","Tile","isBest","this","props","best","x","y","key","style","display","justifyContent","alignItems","textAlign","width","height","border","valid","outline","zIndex","fontFamily","userSelect","MozUserSelect","WebkitUserSelect","msUserSelect","color","backgroundColor","text","prob","onClick","toFixed","React","Component","Map","state","makeEmptyState","doComputation","grid","squidsGotten","probs","observationProb","t0","performance","now","hits","misses","gridValue","push","squids_gotten","Number","$","ajax","url","type","data","JSON","stringify","success","result","is_possible","t1","console","log","probabilities","row","entry","setState","highest_prob","observation_prob","newState","usedShots","margin","fontSize","map","marginLeft","value","onChange","event","target","clearField","App","document","body","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.fbaf8662.chunk.js","sourcesContent":["import React from 'react';\nimport $ from 'jquery';\nimport './App.css';\nconst interpolate = require('color-interpolate');\n\n//const colormap = interpolate(['#004', '#090', '#0a0', 'green']);\nconst colormap = interpolate(['#004', '#0a0', '#0d0', '#0f0', '#6f6']);\nconst naturalsUpTo = (n) => [...Array(n).keys()];\n\nclass Tile extends React.Component {\n    render() {\n        const isBest = this.props.best !== null && this.props.best[0] == this.props.x && this.props.best[1] == this.props.y;\n\n        return <div\n            key={this.props.x + ',' + this.props.y}\n            style={{\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                textAlign: 'center',\n                width: '70px',\n                height: '70px',\n                border: this.props.valid ? '1px solid grey' : '1px solid red',\n                outline: isBest ? '4px solid yellow' : '',\n                zIndex: isBest ? 1 : 0,\n                fontFamily: 'monospace',\n                userSelect: 'none',\n                MozUserSelect: 'none',\n                WebkitUserSelect: 'none',\n                msUserSelect: 'none',\n                color: 'white',\n                backgroundColor: this.props.text === null ? colormap(this.props.prob) : (\n                    this.props.text === 'HIT' ? '#a2a' : '#44a'\n                ),\n            }}\n            onClick={this.props.onClick}\n        >\n            {this.props.text === null ? (this.props.prob * 100).toFixed(2) + '%' : this.props.text}\n        </div>;\n    }\n}\n\nclass Map extends React.Component {\n    constructor() {\n        super();\n        this.state = this.makeEmptyState();\n        this.doComputation(this.state.grid, this.state.squidsGotten);\n    }\n\n    makeEmptyState() {\n        const grid = [];\n        const probs = [];\n        for (let y = 0; y < 8; y++) {\n            for (let x = 0; x < 8; x++) {\n                grid[[x, y]] = null;\n                probs[[x, y]] = 0.0;\n            }\n        }\n        return {grid, squidsGotten: 'unknown', probs, best: [3, 3], valid: true, observationProb: 1.0};\n    }\n\n    doComputation(grid, squidsGotten) {\n        const t0 = performance.now();\n        const hits = [];\n        const misses = [];\n        for (let y = 0; y < 8; y++) {\n            for (let x = 0; x < 8; x++) {\n                const gridValue = grid[[x, y]];\n                if (gridValue === 'HIT')\n                    hits.push([x, y]);\n                if (gridValue === 'MISS')\n                    misses.push([x, y]);\n            }\n        }\n        let squids_gotten = -1;\n        for (const n of ['0', '1', '2'])\n            if (squidsGotten === n)\n                squids_gotten = Number(n);\n        $.ajax({\n            url: 'http://ec2-34-223-48-61.us-west-2.compute.amazonaws.com:1234/sk',\n            type: 'POST',\n            data: JSON.stringify({\n                hits,\n                misses,\n                squids_gotten,\n            }),\n            success: (result) => {\n                if (!result.is_possible) {\n                    this.setState({valid: false});\n                    return;\n                }\n                const t1 = performance.now();\n                console.log('Latency: ' + (t1 - t0) + 'ms');\n                const probs = {...this.state.probs};\n                let y = 0;\n                let x = 0;\n                for (const row of result.probabilities) {\n                    x = 0;\n                    for (const entry of row) {\n                        probs[[x, y]] = entry;\n                        x++;\n                    }\n                    y++;\n                }\n                this.setState({probs, best: result.highest_prob, valid: true, observationProb: result.observation_prob});\n            },\n        });\n    }\n\n    onClick(x, y) {\n        const grid = {...this.state.grid};\n        let gridValue = grid[[x, y]];\n        switch (gridValue) {\n            case null:\n                gridValue = 'MISS';\n                break;\n            case 'MISS':\n                gridValue = 'HIT';\n                break;\n            case 'HIT':\n                gridValue = null;\n                break;\n        }\n        grid[[x, y]] = gridValue;\n        this.setState({grid});\n        this.doComputation(grid, this.state.squidsGotten);\n    }\n\n    clearField() {\n        const newState = this.makeEmptyState();\n        this.setState(newState);\n        this.doComputation(newState.grid, newState.squidsGotten);\n    }\n\n    render() {\n        let usedShots = 0;\n        for (let y = 0; y < 8; y++)\n            for (let x = 0; x < 8; x++)\n                if (this.state.grid[[x, y]] !== null)\n                    usedShots++;\n        return <div style={{\n            margin: '20px',\n        }}>\n            <span style={{fontSize: '150%', color: 'white'}}>Shots used: {usedShots}</span><br/>\n            {naturalsUpTo(8).map(\n                (y) => <div key={y} style={{\n                    display: 'flex',\n                }}>\n                    {naturalsUpTo(8).map(\n                        (x) => <Tile\n                            key={x + ',' + y}\n                            x={x} y={y}\n                            onClick={() => this.onClick(x, y)}\n                            text={this.state.grid[[x, y]]}\n                            prob={this.state.probs[[x, y]]}\n                            valid={this.state.valid}\n                            best={this.state.best}\n                        />\n                    )}\n                </div>\n            )}\n            {this.state.valid || <div style={{fontSize: '150%', color: 'white'}}>Invalid configuration! This is not possible.</div>}\n            <br/>\n            <div style={{fontSize: '150%'}}>\n                <span style={{color: 'white'}}>Number of squids killed:</span>\n                <select\n                    style={{marginLeft: '20px', fontSize: '100%'}}\n                    value={this.state.squidsGotten}\n                    onChange={(event) => {\n                        this.setState({squidsGotten: event.target.value});\n                        this.doComputation(this.state.grid, event.target.value);\n                    }}\n                >\n                    <option value=\"unknown\">Unknown</option>\n                    <option value=\"0\">0</option>\n                    <option value=\"1\">1</option>\n                    <option value=\"2\">2</option>\n                </select>\n                <br/>\n                <span style={{color: 'white', fontSize: '80%'}}>\n                    Probability of this pattern yielding these results: {(100 * this.state.observationProb).toFixed(2) + '%'}\n                </span>\n            </div>\n            <br/>\n            <button style={{fontSize: '150%'}} onClick={() => { this.clearField(); }}>Reset</button>\n        </div>;\n    }\n}\n\nclass App extends React.Component {\n    componentDidMount() {\n        document.body.style.backgroundColor = '#666';\n    }\n\n    render() {\n        return <div style={{\n            textAlign: 'center',\n        }}>\n            <div style={{display: 'inline-block'}}>\n                <div style={{display: 'inline-block', width: '600px'}}>\n                    <h1 style={{color: 'white'}}>Sploosh Kaboom Probability Calculator</h1>\n                    <p style={{color: 'white'}}>\n                        This page gives exact probabilities (no approximation) of hitting a squid in each cell, given the observation of hits, misses, and completed squid kills.\n                        Click on the map to cycle a cell between HIT and MISS.\n                        You can also set the number of squids completely killed in the drop-down menu at the bottom.\n                        You should set this to the value you see in the game for the number of squids killed.\n                        This will yield slightly more accurate probabilities.\n                        The highest probability location to play will be shown with a yellow outline.\n                        If you play perfectly according to picking the highlighted cell you will win in 20 or fewer shots ≈18.5% of the time.\n                    </p>\n                </div>\n                <Map />\n                <span style={{color: 'white'}}>Made by Peter Schmidt-Nielsen</span>\n            </div>\n        </div>;\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}