(this.webpackJsonpsplooshkaboom=this.webpackJsonpsplooshkaboom||[]).push([[0],{16:function(e,t,a){e.exports=a(34)},21:function(e,t,a){},23:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),s=a(15),o=a.n(s),l=(a(21),a(1)),u=a.n(l),c=a(10),d=a(13),h=a(12),f=a(3),m=a(2),p=a(6),v=a(7),b=a(9),y=a(8),g=a(4),w=(a(23),null);var S=0;function k(e,t){var a=t(1*e.length);return(null!==w&&w.buffer===n.memory.buffer||(w=new Uint8Array(n.memory.buffer)),w).set(e,a/1),S=e.length,a}var x=null;function E(e,t){var a=t(4*e.length);return(null!==x&&x.buffer===n.memory.buffer||(x=new Uint32Array(n.memory.buffer)),x).set(e,a/4),S=e.length,a}var T=null;function B(){return null!==T&&T.buffer===n.memory.buffer||(T=new Float64Array(n.memory.buffer)),T}function R(e,t){var a=t(8*e.length);return B().set(e,a/8),S=e.length,a}var M=null;function C(){return null!==M&&M.buffer===n.memory.buffer||(M=new Int32Array(n.memory.buffer)),M}function _(e,t){return B().subarray(e/8,e/8+t)}function O(e,t,a,r,i){var s=k(e,n.__wbindgen_malloc),o=S,l=k(t,n.__wbindgen_malloc),u=S,c=E(r,n.__wbindgen_malloc),d=S,h=R(i,n.__wbindgen_malloc),f=S;n.calculate_probabilities_with_board_constraints(8,s,o,l,u,a,c,d,h,f);var m,p=C()[2],v=C()[3];return 0!==p&&(m=_(p,v).slice(),n.__wbindgen_free(p,8*v)),m}function j(e,t,a,r,i,s){var o=k(e,n.__wbindgen_malloc),l=S,u=k(t,n.__wbindgen_malloc),c=S,d=E(r,n.__wbindgen_malloc),h=S,f=E(i,n.__wbindgen_malloc),m=S,p=R(s,n.__wbindgen_malloc),v=S;n.calculate_probabilities_from_game_history(8,o,l,u,c,a,d,h,f,m,p,v);var b,y=C()[2],g=C()[3];return 0!==y&&(b=_(y,g).slice(),n.__wbindgen_free(y,8*g)),b}function F(e,t,a,r){var i=k(e,n.__wbindgen_malloc),s=S,o=E(t,n.__wbindgen_malloc),l=S,u=E(a,n.__wbindgen_malloc),c=S,d=R(r,n.__wbindgen_malloc),h=S;n.disambiguate_final_board(8,i,s,o,l,u,c,d,h);var f=C()[2],m=C()[3];return 0===f?void 0:m>>>0}function A(e){var t=E(e,n.__wbindgen_malloc),a=S;n.set_board_table(t,a)}function I(e,t){return P.apply(this,arguments)}function P(){return(P=Object(m.a)(u.a.mark((function e(t,a){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("function"===typeof Response&&t instanceof Response)){e.next=23;break}if("function"!==typeof WebAssembly.instantiateStreaming){e.next=15;break}return e.prev=2,e.next=5,WebAssembly.instantiateStreaming(t,a);case 5:return e.abrupt("return",e.sent);case 8:if(e.prev=8,e.t0=e.catch(2),"application/wasm"==t.headers.get("Content-Type")){e.next=14;break}console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e.t0),e.next=15;break;case 14:throw e.t0;case 15:return e.next=17,t.arrayBuffer();case 17:return n=e.sent,e.next=20,WebAssembly.instantiate(n,a);case 20:return e.abrupt("return",e.sent);case 23:return e.next=25,WebAssembly.instantiate(t,a);case 25:if(!((r=e.sent)instanceof WebAssembly.Instance)){e.next=30;break}return e.abrupt("return",{instance:r,module:t});case 30:return e.abrupt("return",r);case 31:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function G(e){return q.apply(this,arguments)}function q(){return(q=Object(m.a)(u.a.mark((function e(t){var a,r,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},("string"===typeof t||"function"===typeof Request&&t instanceof Request||"function"===typeof URL&&t instanceof URL)&&(t=fetch(t)),e.t0=I,e.next=5,t;case 5:return e.t1=e.sent,e.t2=a,e.next=9,(0,e.t0)(e.t1,e.t2);case 9:return r=e.sent,i=r.instance,s=r.module,n=i.exports,G.__wbindgen_wasm_module=s,e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=G,L=a(24),D=null,H=window.indexedDB.open("splooshkaboom",1);function N(e,t){if(null!==D){var a=D.transaction(["sk"],"readwrite");a.oncomplete=function(e){},a.onerror=function(e){alert("Transaction error!")},a.objectStore("sk").add(t,e).onsuccess=function(e){}}}function U(e){return new Promise((function(t,a){var n=D.transaction(["sk"]);n.oncomplete=function(e){},n.onerror=function(e){alert("Transaction error!")};var r=n.objectStore("sk").get(e);r.onsuccess=function(e){t(e.target.result)},r.onerror=function(e){a()}}))}H.onerror=function(e){alert("Failed to access IndexedDB.")},H.onsuccess=function(e){(D=e.target.result).onerror=function(e){alert("IndexedDB error: "+e.target.errorCode)}},H.onupgradeneeded=function(e){e.target.result.createObjectStore("sk")};var V=L(["#004","#070","#090","#0b0","#0d0","#0f0","#6f6"]),W=function(e){return Object(g.a)(Array(e).keys())},K=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"render",value:function(){var e=null!==this.props.best&&this.props.best[0]===this.props.x&&this.props.best[1]===this.props.y,t=this.props.backgroundColor;return void 0===t&&(t=null===this.props.text?V(this.props.prob):"HIT"===this.props.text?"#a2a":"#44a"),i.a.createElement("div",{key:this.props.x+","+this.props.y,style:{display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"70px",height:"70px",border:this.props.valid?"1px solid grey":"1px solid red",outline:e?"4px solid yellow":"",zIndex:e?1:0,fontFamily:"monospace",userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",msUserSelect:"none",color:"white",fontSize:this.props.fontSize,opacity:this.props.opacity,backgroundColor:t},onClick:this.props.onClick},null===this.props.text?(100*this.props.prob).toFixed(this.props.precision)+"%":this.props.text)}}]),a}(i.a.Component),Y=z("/web-sploosh-kaboom/sploosh_wasm_bg.wasm");window.JUST_ONCE=!1;var X=null;function J(e,t){return Z.apply(this,arguments)}function Z(){return(Z=Object(m.a)(u.a.mark((function e(t,a){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){var e=new XMLHttpRequest;return e.open("GET","/web-sploosh-kaboom"+t,!0),e.responseType="arraybuffer",e.onload=function(n){N(t,e.response),a(e.response)},e.send(),null},e.next=3,U(t).catch(n);case 3:if(void 0!==(r=e.sent)){e.next=7;break}return n(),e.abrupt("return");case 7:if(null!==r){e.next=9;break}return e.abrupt("return");case 9:a(r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return Q.apply(this,arguments)}function Q(){return(Q=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){var e=ee();return N("boardIndicesTable",e),e},e.next=3,U("boardIndicesTable").catch(t);case 3:if(void 0!==(a=e.sent)){e.next=6;break}return e.abrupt("return",t());case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){for(var e=[],t=0;t<8;t++)for(var a=0;a<8;a++)for(var n=0,r=[!1,!0];n<r.length;n++){var i=r[n];e.push({x:a,y:t,direction:i})}var s=[],o={};function l(e,t,a){for(var n=0;n<a;n++){var r=t.x,i=t.y;if(t.direction?r+=n:i+=n,r>=8||i>=8)return;e[r+8*i]=a}}for(var u=new Array(64).fill(0),c=0,d=e;c<d.length;c++){var h,m=d[c],p=Object(f.a)(e);try{for(p.s();!(h=p.n()).done;){var v,b=h.value,y=Object(f.a)(e);try{for(y.s();!(v=y.n()).done;){var g=v.value;u.fill(0),l(u,m,2),l(u,b,3),l(u,g,4);var w,S=0,k=Object(f.a)(u);try{for(k.s();!(w=k.n()).done;){S+=w.value}}catch(B){k.e(B)}finally{k.f()}29===S&&s.push(Array.from(u))}}catch(B){y.e(B)}finally{y.f()}}}catch(B){p.e(B)}finally{p.f()}}for(var x=0,E=0,T=s;E<T.length;E++){o[T[E].map((function(e){return 0===e?".":e})).join("")]=x,x++}return o}function te(e){for(var t=Math.round(8*Math.random()),a=Math.round(8*Math.random()),n=Math.random()<.5,r=[[t,a]],i=0;i<e-1;i++){var s=r[r.length-1],o=n?[s[0]+1,s[1]]:[s[0],s[1]+1];r.push(o)}return r}window.JUST_ONCE;var ae=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;return Object(p.a)(this,a),(e=t.call(this)).state={grid:e.makeEmptyGrid(),selectedCell:null},e}return Object(v.a)(a,[{key:"makeEmptyGrid",value:function(){for(var e=[],t=0;t<8;t++)for(var a=0;a<8;a++)e[[a,t]]=".";return e}},{key:"clearBoard",value:function(){this.setState({grid:this.makeEmptyGrid(),selectedCell:null})}},{key:"onClick",value:function(e,t){if(null!==this.state.selectedCell){for(var a=Object(h.a)({},this.state.grid),n=!1,r=0,i=[2,3,4];r<i.length;r++)for(var s=i[r],o=0,l=[[1,0],[0,1],[-1,0],[0,-1]];o<l.length;o++){var u=Object(d.a)(l[o],2),c=u[0],f=u[1];if(this.state.selectedCell[0]===e+c*(s-1)&&this.state.selectedCell[1]===t+f*(s-1)){for(var m=0;m<8;m++)for(var p=0;p<8;p++)a[[p,m]]===""+s&&(a[[p,m]]=".");for(var v=0;v<s;v++)a[[e+v*c,t+v*f]]=""+s;n=!0}}for(var b={2:0,3:0,4:0,".":0},y=0;y<8;y++)for(var g=0;g<8;g++)b[a[[g,y]]]++;for(var w=0,S=[2,3,4];w<S.length;w++){var k=S[w];if(b[k]!==k)for(var x=0;x<8;x++)for(var E=0;E<8;E++)a[[E,x]]===""+k&&(a[[E,x]]=".")}n&&this.setState({grid:a}),this.setState({selectedCell:null})}else this.setState({selectedCell:[e,t]})}},{key:"getLayoutString",value:function(){for(var e="",t=0;t<8;t++)for(var a=0;a<8;a++)e+=this.state.grid[[a,t]];return e}},{key:"setStateFromLayoutString",value:function(e){for(var t=[],a=0;a<8;a++)for(var n=0;n<8;n++)t[[n,a]]=e[n+8*a];this.setState({grid:t})}},{key:"render",value:function(){var e=this,t=this.getLayoutString(),a=this.props.parent.boardIndices[t];void 0===a&&(a="waiting...");var n=function(t,a){return null!==e.state.selectedCell&&t===e.state.selectedCell[0]&&a===e.state.selectedCell[1]};return i.a.createElement("div",{style:{margin:"20px",display:"inline-block",color:"white"}},i.a.createElement("div",{style:{backgroundImage:'url("/web-sploosh-kaboom/board_background_square.png")',backgroundSize:"100% 100%",padding:"18px"}},W(8).map((function(t){return i.a.createElement("div",{key:t,style:{display:"flex"}},W(8).map((function(a){return i.a.createElement(K,{key:a+","+t,x:a,y:t,onClick:function(){return e.onClick(a,t)},text:e.state.grid[[a,t]],valid:!0,best:e.state.selectedCell,fontSize:"200%",opacity:n(a,t)||"."!==e.state.grid[[a,t]]?.6:.2,backgroundColor:"."===e.state.grid[[a,t]]?void 0:"green"})})))}))),i.a.createElement("br",null),"Squid Layout: ",a)}}]),a}(i.a.Component),ne=null;setInterval((function(){null!==ne&&ne.forceUpdate()}),69);var re=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;return Object(p.a)(this,a),e=t.call(this),ne=Object(c.a)(e),e.state={previouslyAccumulatedSeconds:0,timerStartMS:0,timerRunning:!1,includesLoadingTheRoom:!0,includedRewardsGotten:0,invalidated:!1},e}return Object(v.a)(a,[{key:"toggleRunning",value:function(){var e=performance.now(),t=.001*(e-this.state.timerStartMS);this.state.timerRunning&&this.setState({previouslyAccumulatedSeconds:this.state.previouslyAccumulatedSeconds+t}),this.setState({timerRunning:!this.state.timerRunning,timerStartMS:e})}},{key:"adjustRewards",value:function(e){this.setState({includedRewardsGotten:Math.max(0,Math.min(2,this.state.includedRewardsGotten+e))})}},{key:"toggleLoadingTheRoom",value:function(){this.setState({includesLoadingTheRoom:!this.state.includesLoadingTheRoom})}},{key:"toggleInvalidated",value:function(){this.setState({invalidated:!this.state.invalidated})}},{key:"resetTimer",value:function(){this.setState({previouslyAccumulatedSeconds:0,timerStartMS:performance.now(),timerRunning:!1})}},{key:"getSecondsElapsed",value:function(){var e=this.state.previouslyAccumulatedSeconds;this.state.timerRunning&&(e+=.001*(performance.now()-this.state.timerStartMS));return e}},{key:"guessStepsElapsedFromTime",value:function(e){var t=156+252*e;return this.state.includesLoadingTheRoom&&(t+=-940+Number(this.props.roomEnteredOffset)),t+=760*this.state.includedRewardsGotten,Math.round(t)}},{key:"render",value:function(){var e=this.getSecondsElapsed();return this.state.invalidated?i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{style:{fontSize:"150%",color:"white",fontFamily:"monospace"}},"TIMER"),i.a.createElement("span",{style:{fontSize:"150%",color:"white",fontFamily:"monospace"}},"INVALIDATED")):i.a.createElement(i.a.Fragment,null,i.a.createElement("span",null,"\xa0Seconds elapsed: "),i.a.createElement("span",null,"\xa0",e.toFixed(2),"\xa0"),i.a.createElement("span",null,"\xa0Steps:\xa0"),i.a.createElement("span",null,"\xa0",this.guessStepsElapsedFromTime(e),"\xa0"),i.a.createElement("span",null,"\xa0Entered room:"),i.a.createElement("span",null,"\xa0",this.state.includesLoadingTheRoom?i.a.createElement("span",{style:{color:"green",textShadow:"0px 0px 2px white"}},"YES"):i.a.createElement("span",{style:{color:"red",textShadow:"0px 0px 2px white"}},"NO"),"\xa0"),i.a.createElement("span",null,"\xa0Rewards gotten:\xa0"),i.a.createElement("span",null,"\xa0",this.state.includedRewardsGotten,"\xa0"))}}]),a}(i.a.Component);var ie=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;return Object(p.a)(this,a),(e=t.call(this)).videoRef=i.a.createRef(),e.canvasRef=i.a.createRef(),e.outputCanvasRef=i.a.createRef(),e.hiddenAreaRef=i.a.createRef(),e.layoutDrawingBoardRefs=[i.a.createRef(),i.a.createRef(),i.a.createRef()],e.timerRef=i.a.createRef(),e.state=e.makeEmptyState(),e.bannerCache=new Map,window.RECOMP=function(){e.bannerCache=new Map,e.getBoardRegistrationAndScale()},X=Object(c.a)(e),e.previouslyReadStates=[null,null,null],e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){this.makeReferenceImageCanvases(),this.doComputation(this.state.grid,this.state.squidsGotten)}},{key:"makeReferenceImageCanvases",value:function(){var e=this,t=this.hiddenAreaRef.current;this.referenceCanvases={};for(var a=function(){var a=r[n],i=document.createElement("canvas");i.setAttribute("id","canvas_"+a),t.appendChild(i);var s=document.createElement("img");s.src="/web-sploosh-kaboom/images/"+a+".png",s.onload=function(){i.width=this.width,i.height=this.height,i.getContext("2d").drawImage(s,0,0)},e.referenceCanvases[a]=i},n=0,r=["hit","miss","killed_squid","remaining_squid","top_banner_new","bottom_banner_new"];n<r.length;n++)a()}},{key:"makeEmptyGrid",value:function(){for(var e=[],t=0;t<8;t++)for(var a=0;a<8;a++)e[[a,t]]=null;return e}},{key:"makeEmptyState",value:function(){for(var e=[],t=0;t<8;t++)for(var a=0;a<8;a++)e[[a,t]]=0;return{mode:"calculator",squidLayout:function(){for(var e={},t={},a=0,n=[2,3,4];a<n.length;a++)for(var r=n[a];;){var i,s=te(r),o=!0,l=Object(f.a)(s);try{for(l.s();!(i=l.n()).done;){var u=i.value;(u[0]>7||u[1]>7||!0===t[u])&&(o=!1)}}catch(h){l.e(h)}finally{l.f()}if(o){e["squid"+r]=s;var c,d=Object(f.a)(s);try{for(d.s();!(c=d.n()).done;){t[c.value]=!0}}catch(h){d.e(h)}finally{d.f()}break}}return e}(),grid:this.makeEmptyGrid(),squidsGotten:"unknown",undoBuffer:[],probs:e,best:[3,3],cursorBelief:[3,3],valid:!0,observationProb:1,screenRecordingActive:!1,doVideoProcessing:!1,lastComputationTime:-1,lastCVTime:-1,turboBlurboMode:!1,turboBlurboTiming:!1,showKeyShortcuts:!1,timerStepEstimate:null,potentialMatches:[],firstBoardStepsThousands:500,firstBoardStepsThousandsStdDev:500,nextBoardStepsThousands:7,nextBoardStepsThousandsStdDev:3,timedBoardStepsThousandsStdDev:.2,roomEnteredOffset:0}}},{key:"startScreenRecording",value:function(){var e=Object(m.a)(u.a.mark((function e(){var t,a,n,r,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.screenRecordingActive){e.next=3;break}return alert("Already screen capturing!"),e.abrupt("return");case 3:return t={video:{cursor:"always"},audio:!1},e.next=6,navigator.mediaDevices.getDisplayMedia(t);case 6:return a=e.sent,(n=this.videoRef.current).srcObject=a,n.play(),this.setState({screenRecordingActive:!0}),e.next=13,new Promise((function(e){return setTimeout(e,500)}));case 13:this.updateCapture(),r=this.canvasRef.current,i=this.outputCanvasRef.current,console.log(r,i,r.width,r.height),i.width=r.width,i.height=r.height,i.getContext("2d").drawImage(r,0,0);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeTurboBlurboMode",value:function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,r,i=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===this.state.turboBlurboMode){e.next=2;break}return e.abrupt("return");case 2:return this.setState({turboBlurboMode:"initializing"}),e.next=5,$();case 5:for(this.boardIndices=e.sent,this.boardIndexToLayoutString=new Array(Object.keys(this.boardIndices).length),a=0,n=Object.keys(this.boardIndices);a<n.length;a++)r=n[a],this.boardIndexToLayoutString[this.boardIndices[r]]=r;J(t?"/board_table_25M.bin":"/board_table_5M.bin",(function(e){i.boardTable=new Uint32Array(e),console.log("Board table length:",i.boardTable.length);var t,a=Object(f.a)(i.boardTable);try{for(a.s();!(t=a.n()).done;){var n=t.value;n>604583&&alert("BUG BUG BUG: Bad value in board table: "+n)}}catch(r){a.e(r)}finally{a.f()}A(i.boardTable),i.setState({turboBlurboMode:!0,squidsGotten:"0",mode:"calculator"})}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleVideoProcessing",value:function(){if(this.state.screenRecordingActive)if(!1!==this.state.doVideoProcessing||this.readyToProcess()){if(this.setState({doVideoProcessing:!this.state.doVideoProcessing}),null!==this.previouslyReadStates[this.previouslyReadStates.length-1]){var e=this.previouslyReadStates[this.previouslyReadStates.length-1];this.setState(e),this.doComputation(e.grid,e.squidsGotten),this.previouslyReadStates[this.previouslyReadStates.length-1]=null}}else alert("You must first detect a board.")}},{key:"getBoardRegistrationAndScale",value:function(){var e=Object(m.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.screenRecordingActive){e.next=2;break}return e.abrupt("return");case 2:this.updateCapture(),t=.375,a=.7,n=0;case 6:if(!(n<10)){e.next=15;break}return e.next=9,this.performGridSearch(t*(1-a),t*(1+2*a),0===n?20:1===n?10:4);case 9:this.boardFitParams=e.sent,t=this.boardFitParams.scale,a/=2;case 12:n++,e.next=6;break;case 15:return console.log("Best fit params:",this.boardFitParams),this.bannerCache.delete(t),this.testForTopBannerAtScale(t),this.testForBottomBanner(),console.log("Final fit params:",this.boardFitParams),e.next=22,new Promise((function(e){return setTimeout(e,100)}));case 22:this.setState({doVideoProcessing:!0});case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"performGridSearch",value:function(){var e=Object(m.a)(u.a.mark((function e(t,a,n){var r,i,s,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={score:-1},i=0;case 2:if(!(i<n)){e.next=11;break}return s=t+i*(a-t)/(n-1),(o=this.testForTopBannerAtScale(s)).score>r.score&&(r=o),e.next=8,new Promise((function(e){return setTimeout(e,10)}));case 8:i++,e.next=2;break;case 11:return console.log("Grid search over:",t,"to",a,"got:",r),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"testForBottomBanner",value:function(){var e=window.cv.imread("cv_canvasRef"),t=window.cv.imread("canvas_bottom_banner_new"),a=Math.round(t.size().width*this.boardFitParams.scale),n=Math.round(t.size().height*this.boardFitParams.scale),r=new window.cv.Mat,i=new window.cv.Size(a,n);window.cv.resize(t,r,i,0,0,window.cv.INTER_AREA);var s=new window.cv.Mat,o=new window.cv.Mat,l=window.cv.TM_CCOEFF_NORMED;window.cv.matchTemplate(e,r,s,l,o);var u=window.cv.minMaxLoc(s,o).maxLoc,c=new window.cv.Scalar(255,0,0,255),d=new window.cv.Point(u.x+r.cols,u.y+r.rows);window.cv.rectangle(e,u,d,c,2,window.cv.LINE_8,0),window.cv.imshow("cv_outputCanvasRef",e),e.delete(),t.delete(),r.delete(),s.delete(),o.delete(),this.boardFitParams.bottomBannerOffset={x:u.x,y:u.y}}},{key:"getCellXY",value:function(e,t){var a=(this.boardFitParams.bottomBannerOffset.y-this.boardFitParams.topBannerOffset.y)/(828*this.boardFitParams.scale);return(a<.95||a>1.05)&&(a=1),{x:this.boardFitParams.topBannerOffset.x+this.boardFitParams.scale*(161.5+75.5*e),y:this.boardFitParams.topBannerOffset.y+this.boardFitParams.scale*a*(239+78.6*t)}}},{key:"getSquidIndicatorXY",value:function(e){var t=(this.boardFitParams.bottomBannerOffset.y-this.boardFitParams.topBannerOffset.y)/(828*this.boardFitParams.scale);return(t<.95||t>1.05)&&(t=1),{x:this.boardFitParams.topBannerOffset.x+948*this.boardFitParams.scale,y:this.boardFitParams.topBannerOffset.y+this.boardFitParams.scale*t*(185+133*e)}}},{key:"getBoardRect",value:function(){var e=(this.boardFitParams.bottomBannerOffset.y-this.boardFitParams.topBannerOffset.y)/(828*this.boardFitParams.scale);return(e<.95||e>1.05)&&(e=1),new window.cv.Rect(Math.round(this.boardFitParams.topBannerOffset.x),Math.round(this.boardFitParams.topBannerOffset.y),Math.round(1040*this.boardFitParams.scale),Math.round(this.boardFitParams.scale*e*940))}},{key:"testForTopBannerAtScale",value:function(e){if(this.bannerCache.has(e))return this.bannerCache.get(e);var t=window.cv.imread("cv_canvasRef"),a=window.cv.imread("canvas_top_banner_new"),n=Math.round(a.size().width*e),r=Math.round(a.size().height*e),i=new window.cv.Mat,s=new window.cv.Size(n,r);window.cv.resize(a,i,s,0,0,window.cv.INTER_AREA);var o=new window.cv.Mat,l=new window.cv.Mat,u=window.cv.TM_CCOEFF_NORMED;window.cv.matchTemplate(t,i,o,u,l);var c=window.cv.minMaxLoc(o,l),d=c.maxLoc,h=new window.cv.Scalar(255,0,0,255),f=new window.cv.Point(d.x+i.cols,d.y+i.rows);window.cv.rectangle(t,d,f,h,2,window.cv.LINE_8,0),window.cv.imshow("cv_outputCanvasRef",t),t.delete(),a.delete(),i.delete(),o.delete(),l.delete();var m=c.maxVal;return this.bannerCache.set(e,m),{score:m,scale:e,topBannerOffset:{x:d.x,y:d.y}}}},{key:"readyToProcess",value:function(){return this.state.screenRecordingActive&&void 0!==this.boardFitParams&&this.boardFitParams.hasOwnProperty("bottomBannerOffset")}},{key:"readBoardState",value:function(){var e=Object(m.a)(u.a.mark((function e(){var t,a,n,r,i,s,o,l,c,d,f,m,p,v,b,y,g,w,S,k,x,E,T,B,R,M,C,_,O,j,F,A,I,P,G,q,z,L,D,H,N,U,V,W,K,Y,X,J,Z,$,Q,ee,te,ae,ne,re,ie,se,oe,le;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(le=function(e,t){if(null===e||null===t)return!1;for(var a=e.squidsGotten===t.squidsGotten,n=0;n<8;n++)for(var r=0;r<8;r++)e.grid[[r,n]]!==t.grid[[r,n]]&&(a=!1);return a},this.readyToProcess()){e.next=3;break}return e.abrupt("return");case 3:for(t={grid:{},squidsGotten:0},this.updateCapture(),a=performance.now(),n=window.cv.imread("cv_canvasRef"),r=new window.cv.Size(3,3),window.cv.GaussianBlur(n,n,r,0,0,window.cv.BORDER_DEFAULT),i=[n],s=function(e,t){var a=n.ucharPtr(Math.round(t),Math.round(e)),r={r:a[0],g:a[1],b:a[2]},i=Math.sqrt(r.r*r.r+r.g*r.g+r.b*r.b);return Object(h.a)({},r,{energy:i})},o=new window.cv.Scalar(80,80,80,255),l=new window.cv.Scalar(255,0,255,255),c=new window.cv.Scalar(100,255,0,255),d=new window.cv.Scalar(255,100,100,255),f=new window.cv.Scalar(50,255,100,255),m=null,p=-1,v=0;v<8;v++)for(b=0;b<8;b++)y=this.getCellXY(b,v),(g=s(y.x,y.y+15)).energy>p&&(p=g.energy,m={x:b,y:v});for(w=0;w<8;w++)for(S=0;S<8;S++)k=this.getCellXY(S,w),x=k.x,E=k.y,2,T=s(x,E),B=s(x-2,E-2),R=s(x+2,E-2),M=s(x-2,E+2),C=s(x+2,E+2),_=S===m.x&&w===m.y,O=_||S===m.x+1&&w===m.y,j=_||S===m.x-1&&w===m.y,F=_||S===m.x&&w===m.y+1,A=_||S===m.x&&w===m.y-1,I=F||O,P=F||j,G=A||O,q=A||j,z=o,L=_?240:220,D=(T.energy>=L)+(B.energy>=(I?240:220))+(R.energy>=(P?240:220))+(M.energy>=(G?240:220))+(C.energy>=(G?240:220)),H=_?1:1.02,N=(T.g>=T.b*H)+(B.g>=B.b*(I?H:1.05))+(R.g>=R.b*(P?H:1.05))+(M.g>=M.b*(G?H:1.05))+(C.g>=C.b*(q?H:1.05)),t.grid[[S,w]]=null,(D>=4&&N>=3||D>=3&&N>=4)&&(U=Math.max(T.r,B.r,R.r,M.r,C.r),V=Math.max(T.g,B.g,R.g,M.g,C.g),U>1.25*V?(z=l,t.grid[[S,w]]="HIT"):(z=c,t.grid[[S,w]]="MISS")),window.JUST_ONCE&&(_&&console.log("INSIDE!!!!!"),console.log("Scores:",S,w,_,N,T,B,R,M,C)),W=new window.cv.Point(x-7,E-7),K=new window.cv.Point(x+7,E+7),window.cv.rectangle(n,W,K,z,1,window.cv.LINE_8,0);for(Y=0;Y<3;Y++)X=this.getSquidIndicatorXY(Y),J=X.x,Z=X.y,$=n.ucharPtr(Math.round(Z),Math.round(J)),Q={r:$[0],g:$[1],b:$[2]},ee=new window.cv.Point(J-15,Z-15),te=new window.cv.Point(J+15,Z+15),ae=f,Q.r>1.25*Q.b&&(ae=d,t.squidsGotten=Math.max(t.squidsGotten,Y+1)),window.cv.rectangle(n,ee,te,ae,1,window.cv.LINE_8,0);for(ne=this.getBoardRect(),re=n.roi(ne),i.push(re),window.cv.imshow("cv_outputCanvasRef",re),ie=0,se=i;ie<se.length;ie++)se[ie].delete();if(oe=performance.now(),console.log("CV took: "+(oe-a)+"ms"),this.setState({lastCVTime:oe-a}),le(this.previouslyReadStates[0],this.previouslyReadStates[1])||!le(this.previouslyReadStates[1],this.previouslyReadStates[2])||!le(this.previouslyReadStates[2],t)){e.next=33;break}return this.setState(t),e.next=33,this.doComputation(t.grid,t.squidsGotten);case 33:return this.previouslyReadStates.shift(),this.previouslyReadStates.push(t),e.abrupt("return",t);case 36:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCapture",value:function(){var e=this.videoRef.current,t=this.canvasRef.current,a=t.getContext("2d"),n=Math.round(e.videoHeight/e.videoWidth*960);console.log("Native image capture shape: "+e.videoWidth+"x"+e.videoHeight+" -> scaling to: 960x"+n),t.width=960,t.height=n,a.drawImage(e,0,0,960,n)}},{key:"findMatchingLocations",value:u.a.mark((function e(t,a,n){var r,i,s,o,l,c,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=4;break}return e.next=3,[];case 3:return e.abrupt("return");case 4:r=t[0],i=this.boardTable,s=Math.min(i.length,a+n),o=a;case 8:if(!(o<s)){e.next=30;break}if(i[o]!==r){e.next=27;break}l=Object(f.a)(this.findMatchingLocations(t.slice(1),o,15e3)),e.prev=11,l.s();case 13:if((c=l.n()).done){e.next=19;break}return d=c.value,e.next=17,[o].concat(Object(g.a)(d));case 17:e.next=13;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(11),l.e(e.t0);case 24:return e.prev=24,l.f(),e.finish(24);case 27:o++,e.next=8;break;case 30:case"end":return e.stop()}}),e,this,[[11,21,24,27]])}))},{key:"recomputePotentialMatches",value:function(){var e,t=this.makeGameHistoryArguments(),a=Object(d.a)(t,3),n=a[0],r=(a[1],a[2],[]),i=Object(f.a)(this.findMatchingLocations(n,0,1e9));try{for(i.s();!(e=i.n()).done;){var s=e.value;r.push(s)}}catch(o){i.e(o)}finally{i.f()}this.setState({potentialMatches:r})}},{key:"makeGameHistoryArguments",value:function(){var e,t=this,a=this.layoutDrawingBoardRefs.map((function(e){return t.boardIndices[e.current.getLayoutString()]})),n=[],r=Object(f.a)(a);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(void 0===i)break;n.push(i)}}catch(h){r.e(h)}finally{r.f()}for(var s=[],o=[],l=!0,u=0,c=[].concat(n,[null]);u<c.length;u++){var d=c[u];if(void 0===d)break;l?(s.push(1e3*Number(this.state.firstBoardStepsThousands)),o.push(1e3*Number(this.state.firstBoardStepsThousandsStdDev))):null===d&&null!==this.state.timerStepEstimate?(s.push(Math.max(0,this.state.timerStepEstimate)),o.push(1e3*Number(this.state.timedBoardStepsThousandsStdDev))):(s.push(1e3*Number(this.state.nextBoardStepsThousands)),o.push(1e3*Number(this.state.nextBoardStepsThousandsStdDev))),l=!1}return[Uint32Array.from(n),Uint32Array.from(s),Float64Array.from(o)]}},{key:"getGridStatistics",value:function(e,t){for(var a=[],n=[],r=0;r<8;r++)for(var i=0;i<8;i++){var s=e[[i,r]];"HIT"===s&&a.push(8*r+i),"MISS"===s&&n.push(8*r+i)}for(var o=-1,l=0,u=["0","1","2","3"];l<u.length;l++){var c=u[l];t!==c&&t!==Number(c)||(o=Number(c))}return{hits:a,misses:n,numericSquidsGotten:o}}},{key:"doComputation",value:function(){var e=Object(m.a)(u.a.mark((function e(t,a){var n,r,i,s,o,l,c,d,h,f,m,p,v,b,y,w,S,k;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Doing computation:",a,t),n=performance.now(),r=this.getGridStatistics(t,a),i=r.hits,s=r.misses,o=r.numericSquidsGotten,e.next=5,Y;case 5:if(this.state.turboBlurboMode?(c=this.makeGameHistoryArguments(),console.log("gameHistoryArguments:",c),l=j.apply(void 0,[Uint8Array.from(i),Uint8Array.from(s),o].concat(Object(g.a)(c)))):l=O(Uint8Array.from(i),Uint8Array.from(s),o,Uint32Array.from([]),Float64Array.from([])),void 0!==l){for(d=0,h=0,f=-1,m=[],p=0;p<8;p++)for(v=0;v<8;v++)m[[v,p]]=l[8*p+v],u=this.state.cursorBelief,x=[v,p],b=Math.abs(u[0]-x[0])+Math.abs(u[1]-x[1]),y=1-.03*b,w=l[8*p+v]*y,null===t[[v,p]]&&w>f&&(f=w,h=v,d=p);S=l[64],this.setState({probs:m,best:f>=0?[h,d]:null,valid:!0,observationProb:S})}else this.setState({valid:!1});k=performance.now(),this.setState({lastComputationTime:k-n});case 9:case"end":return e.stop()}var u,x}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"copyToUndoBuffer",value:function(){this.setState({undoBuffer:[].concat(Object(g.a)(this.state.undoBuffer),[{grid:this.state.grid,squidsGotten:this.state.squidsGotten,cursorBelief:this.state.cursorBelief}])})}},{key:"onClick",value:function(e,t,a){var n=Object(h.a)({},this.state.grid),r=n[[e,t]],i=this.state.squidsGotten;if(this.copyToUndoBuffer(),"calculator"===this.state.mode){switch(r){case null:r=a?"HIT":"MISS";break;case"MISS":r="HIT";break;case"HIT":r=null}n[[e,t]]=r}else{if(null!==r)return;r=function(a){var n,r=Object(f.a)(a);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i[0]===e&&i[1]===t)return!0}}catch(s){r.e(s)}finally{r.f()}return!1}([].concat(Object(g.a)(this.state.squidLayout.squid2),Object(g.a)(this.state.squidLayout.squid3),Object(g.a)(this.state.squidLayout.squid4)))?"HIT":"MISS",n[[e,t]]=r,i=0;for(var s=0,o=["2","3","4"];s<o.length;s++){var l,u=o[s],c=this.state.squidLayout["squid"+u],d=!0,m=Object(f.a)(c);try{for(m.s();!(l=m.n()).done;){"HIT"!==n[l.value]&&(d=!1)}}catch(p){m.e(p)}finally{m.f()}i+=d}this.setState({squidsGotten:i})}this.setState({grid:n,cursorBelief:[e,t]}),this.doComputation(n,i)}},{key:"clearField",value:function(){for(var e=this.makeEmptyState(),t={},a=0,n=["squidLayout","grid","squidsGotten","undoBuffer","cursorBelief"];a<n.length;a++){var r=n[a];t[r]=e[r]}this.state.turboBlurboMode&&(t.squidsGotten="0"),this.setState(t),this.doComputation(t.grid,t.squidsGotten)}},{key:"undoLastMarking",value:function(){var e=Object(g.a)(this.state.undoBuffer);if(0!==e.length){var t=e.pop();this.setState({grid:t.grid,squidsGotten:t.squidsGotten,cursorBelief:t.cursorBelief,undoBuffer:e}),this.doComputation(t.grid,t.squidsGotten)}}},{key:"reportMiss",value:function(){null!==this.state.best&&null===this.state.grid[this.state.best]&&this.onClick.apply(this,Object(g.a)(this.state.best))}},{key:"reportHit",value:function(){if(null!==this.state.best&&null===this.state.grid[this.state.best]){this.onClick.apply(this,Object(g.a)(this.state.best).concat([!0]));var e=this.getGridStatistics(this.state.grid,this.state.squidsGotten),t=e.hits;e.misses,e.numericSquidsGotten;9===t.length&&this.incrementKills()}}},{key:"splitTimer",value:function(){var e=this.timerRef.current;if(null!==e){var t=e.state.invalidated?null:e.guessStepsElapsedFromTime(e.getSecondsElapsed());this.setState({timerStepEstimate:t}),console.log("Timer step estimate:",t),e.setState({previouslyAccumulatedSeconds:0,timerStartMS:performance.now(),includesLoadingTheRoom:!1,includedRewardsGotten:0,timerRunning:!0,invalidated:!1}),this.doComputation(this.state.grid,this.state.squidsGotten)}}},{key:"incrementKills",value:function(){var e=Object(m.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.copyToUndoBuffer(),t="unknown"===this.state.squidsGotten?0:Number(this.state.squidsGotten),a=this.state.grid,4!==++t){e.next=11;break}return n=this.makeGameHistoryArguments(),this.splitTimer(),e.next=9,this.copyToHistory(n);case 9:e.sent?(t=0,a=this.makeEmptyGrid(),this.setState({undoBuffer:[],cursorBelief:[3,3]})):t=3;case 11:this.setState({grid:a,squidsGotten:""+t}),this.doComputation(a,""+t);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"copyToHistory",value:function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,r,i,s,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.getGridStatistics(this.state.grid,this.state.squidsGotten),n=a.hits,void 0===t&&(t=this.makeGameHistoryArguments()),e.next=4,Y;case 4:if(void 0!==(r=F.apply(void 0,[Uint8Array.from(n)].concat(Object(g.a)(t))))){e.next=7;break}return e.abrupt("return",!1);case 7:return console.log("Final board:",r),i=this.boardIndexToLayoutString[r],s=t[0],(o=s.length)===this.layoutDrawingBoardRefs.length&&(this.shiftHistory(),o--),this.layoutDrawingBoardRefs[o].current.setStateFromLayoutString(i),e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shiftHistory",value:function(){for(var e=this.layoutDrawingBoardRefs.map((function(e){return e.current})),t=0;t<e.length-1;t++)e[t].setState(e[t+1].state);e[e.length-1].clearBoard()}},{key:"renderActualMap",value:function(e){var t=this;return i.a.createElement("div",{style:{justifySelf:"center"}},W(8).map((function(a){return i.a.createElement("div",{key:a,style:{display:"flex"}},W(8).map((function(n){return i.a.createElement(K,{key:n+","+a,x:n,y:a,onClick:function(){return t.onClick(n,a)},text:t.state.grid[[n,a]],prob:t.state.probs[[n,a]],valid:t.state.valid,best:t.state.best,precision:e?0:2,opacity:e?.5+.3*t.state.probs[[n,a]]:void 0})})))})))}},{key:"renderOverlayMap",value:function(){if(this.state.doVideoProcessing)return i.a.createElement("div",{style:{position:"absolute",top:"210px",left:"127px",transform:"scale(1.01, 1.05)",zIndex:20,display:"inline-block"}},this.renderActualMap(!0))}},{key:"render",value:function(){for(var e=this,t=0,a=!0,n=0;n<8;n++)for(var r=0;r<8;r++)null!==this.state.grid[[r,n]]&&(t++,"HIT"===this.state.grid[[r,n]]&&(a=!1));return i.a.createElement("div",{style:{margin:"20px",color:"white"}},i.a.createElement("div",{className:"container"},i.a.createElement("div",{style:{justifySelf:"end",alignSelf:"start"}},i.a.createElement("div",{className:"tableContainer",style:{gridTemplateColumns:"repeat(2, 1fr)"}},i.a.createElement("span",null,i.a.createElement("strong",null,"\xa0Item\xa0")),i.a.createElement("span",null,i.a.createElement("strong",null,"\xa0Value\xa0")),i.a.createElement("span",null,"\xa0Shots used:\xa0"),i.a.createElement("span",null,"\xa0",t,"\xa0"),this.state.turboBlurboMode&&this.state.turboBlurboTiming&&i.a.createElement(i.a.Fragment,null,i.a.createElement(re,{ref:this.timerRef,roomEnteredOffset:this.state.roomEnteredOffset}),i.a.createElement("span",null,"\xa0Last steps:\xa0"),i.a.createElement("span",null,"\xa0",null===this.state.timerStepEstimate?"-":this.state.timerStepEstimate,"\xa0")),this.state.turboBlurboMode&&this.state.turboBlurboTiming&&this.state.showKeyShortcuts&&i.a.createElement(i.a.Fragment,null,i.a.createElement("span",null,i.a.createElement("strong",null,"\xa0Control\xa0")),i.a.createElement("span",null,i.a.createElement("strong",null,"\xa0Shortcut\xa0")),i.a.createElement("span",null,"\xa0Toggle Timer\xa0"),i.a.createElement("span",null,"\xa0Space\xa0"),i.a.createElement("span",null,"\xa0Add Reward\xa0"),i.a.createElement("span",null,"\xa0,\xa0"),i.a.createElement("span",null,"\xa0Remove Reward\xa0"),i.a.createElement("span",null,"\xa0<\xa0"),i.a.createElement("span",null,"\xa0Toggle Room Entered\xa0"),i.a.createElement("span",null,"\xa0m\xa0"),i.a.createElement("span",null,"\xa0Invalidate Timer\xa0"),i.a.createElement("span",null,"\xa0;\xa0"),i.a.createElement("span",null,"\xa0Reset Timer\xa0"),i.a.createElement("span",null,"\xa0:\xa0"),i.a.createElement("span",null,"\xa0Split Timer\xa0"),i.a.createElement("span",null,"\xa0s\xa0"))),this.state.turboBlurboMode&&this.state.turboBlurboTiming&&i.a.createElement("button",{style:{fontSize:"150%",margin:"10px"},onClick:function(){e.setState({showKeyShortcuts:!e.state.showKeyShortcuts})}},"Toggle Show Shortcuts")),this.state.doVideoProcessing||this.renderActualMap(!1),i.a.createElement("span",{style:{display:"inline-block"}})),this.state.valid||this.state.turboBlurboMode||i.a.createElement("div",{style:{fontSize:"150%",color:"white"}},"Invalid configuration! This is not possible."),i.a.createElement("br",null),i.a.createElement("div",{style:{fontSize:"150%"}},i.a.createElement("span",{style:{color:"white"}},"Number of squids killed:"),i.a.createElement("select",{style:{marginLeft:"20px",fontSize:"100%"},value:this.state.squidsGotten,onChange:function(t){e.setState({squidsGotten:t.target.value}),e.doComputation(e.state.grid,t.target.value)}},this.state.turboBlurboMode||i.a.createElement("option",{value:"unknown"},"Unknown"),i.a.createElement("option",{value:"0"},"0"),i.a.createElement("option",{value:"1"},"1"),i.a.createElement("option",{value:"2"},"2"),i.a.createElement("option",{value:"3"},"3")),i.a.createElement("br",null)),i.a.createElement("br",null),this.state.turboBlurboMode&&i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{style:{fontSize:"150%",margin:"10px"},onClick:function(){e.reportMiss()}},"Miss (z)"),i.a.createElement("button",{style:{fontSize:"150%",margin:"10px"},onClick:function(){e.reportHit()}},"Hit (x)"),i.a.createElement("button",{style:{fontSize:"150%",margin:"10px"},onClick:function(){e.copyToHistory()}},"Copy to History (h)"),i.a.createElement("button",{style:{fontSize:"150%",margin:"10px"},onClick:function(){e.shiftHistory()}},"Shift History")),i.a.createElement("button",{style:{fontSize:"150%",margin:"10px"},onClick:function(){e.incrementKills()}},"Increment Kills (c)"),i.a.createElement("button",{style:{fontSize:"150%",margin:"10px"},onClick:function(){e.clearField()}},"Reset"),this.state.turboBlurboMode||i.a.createElement("select",{style:{marginLeft:"20px",fontSize:"150%"},value:this.state.mode,onChange:function(t){return e.setState({mode:t.target.value})}},i.a.createElement("option",{value:"calculator"},"Calculator Mode"),i.a.createElement("option",{value:"practice"},"Practice Mode")),this.state.turboBlurboMode&&i.a.createElement("div",{style:{display:"inline-block",margin:"10px",border:"1px solid white",borderRadius:"5px",fontSize:"130%",padding:"5px"}},i.a.createElement("span",{style:{margin:"5px"}},"Timer mode:"),i.a.createElement("input",{type:"checkbox",checked:this.state.turboBlurboTiming,onChange:function(t){return e.setState({turboBlurboTiming:!e.state.turboBlurboTiming})},style:{margin:"10px",transform:"scale(2)"}})),i.a.createElement("br",null),a&&!this.state.screenRecordingActive&&"calculator"===this.state.mode&&!this.state.turboBlurboMode&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{color:"white",fontSize:"120%",marginTop:"20px"}},"Opening optimizer: Probability that this",i.a.createElement("br",null),"pattern would get at least one hit: ",this.state.valid?(100*Math.max(0,1-this.state.observationProb)).toFixed(2)+"%":"Invalid")),i.a.createElement("br",null),i.a.createElement("hr",null),"initializing"===this.state.turboBlurboMode&&i.a.createElement("div",{style:{fontSize:"150%",color:"white"}},"Downloading table...",i.a.createElement("br",null)),!0===this.state.turboBlurboMode&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,this.layoutDrawingBoardRefs.map((function(t,a){return i.a.createElement(ae,{parent:e,ref:t,key:a})}))),i.a.createElement("div",{style:{color:"white",fontSize:"130%"}},"Gaussian RNG step count beliefs (all counts in ",i.a.createElement("i",null,"thousands"),' of steps, except "Room entered offset"):',i.a.createElement("br",null),"First board mean:    ",i.a.createElement("input",{style:{width:"50px"},value:this.state.firstBoardStepsThousands,onChange:function(t){return e.setState({firstBoardStepsThousands:t.target.value})}})," \xa0 First board stddev:  ",i.a.createElement("input",{style:{width:"50px"},value:this.state.firstBoardStepsThousandsStdDev,onChange:function(t){return e.setState({firstBoardStepsThousandsStdDev:t.target.value})}})," \xa0 Next board mean:     ",i.a.createElement("input",{style:{width:"50px"},value:this.state.nextBoardStepsThousands,onChange:function(t){return e.setState({nextBoardStepsThousands:t.target.value})}})," \xa0 Next board stddev:   ",i.a.createElement("input",{style:{width:"50px"},value:this.state.nextBoardStepsThousandsStdDev,onChange:function(t){return e.setState({nextBoardStepsThousandsStdDev:t.target.value})}})," \xa0 Timed board stddev:  ",i.a.createElement("input",{style:{width:"50px"},value:this.state.timedBoardStepsThousandsStdDev,onChange:function(t){return e.setState({timedBoardStepsThousandsStdDev:t.target.value})}}),"\xa0 Room entered offset: ",i.a.createElement("input",{style:{width:"50px"},value:this.state.roomEnteredOffset,onChange:function(t){return e.setState({roomEnteredOffset:t.target.value})}})),i.a.createElement("div",{style:{margin:"20px",color:"white",fontSize:"130%",border:"1px solid white",width:"400px",minHeight:"20px",display:"inline-block"}},this.state.potentialMatches.map((function(e,t){var a=e.slice(1);return i.a.createElement("div",{key:t},"Potential match: ",e[0],a.map((function(t,a){return i.a.createElement(i.a.Fragment,null," +",t-e[a])})))}))),i.a.createElement("br",null),i.a.createElement("button",{style:{fontSize:"150%",margin:"10px"},onClick:function(){e.recomputePotentialMatches()}},"Find Match Indices"),i.a.createElement("div",{style:{fontSize:"150%",color:"white"}},"Turbo blurbo mode initialized.",i.a.createElement("br",null))),i.a.createElement("button",{disabled:!1!==this.state.turboBlurboMode,style:{fontSize:"150%",margin:"10px"},onClick:function(){e.initializeTurboBlurboMode(!1)}},"Initialize Turbo Blurbo Mode"),i.a.createElement("br",null),i.a.createElement("button",{disabled:!1!==this.state.turboBlurboMode,style:{fontSize:"150%",margin:"10px"},onClick:function(){e.initializeTurboBlurboMode(!0)}},"Initialize Turbo Blurbo Mode (big table)"),i.a.createElement("br",null),i.a.createElement("span",{style:{color:"white"}},"Last recompute time: ",this.state.lastComputationTime,"ms"),i.a.createElement("div",{style:{display:"none"},ref:this.hiddenAreaRef}))}}]),a}(i.a.Component);document.addEventListener("keydown",(function(e){"p"===e.key&&null!==X&&X.toggleVideoProcessing(),"z"===e.key&&e.ctrlKey?X.undoLastMarking():"z"!==e.key&&"y"!==e.key||null===X||X.reportMiss(),"x"===e.key&&null!==X&&X.reportHit(),"c"===e.key&&null!==X&&X.incrementKills(),"s"===e.key&&null!==X&&X.splitTimer(),"h"===e.key&&null!==X&&X.copyToHistory()," "===e.key&&null!==ne&&(ne.toggleRunning(),e.preventDefault()),","===e.key&&null!==ne&&ne.adjustRewards(1),"<"===e.key&&null!==ne&&ne.adjustRewards(-1),"m"===e.key&&null!==ne&&ne.toggleLoadingTheRoom(),";"===e.key&&null!==ne&&ne.toggleInvalidated(),":"===e.key&&null!==ne&&ne.resetTimer()}));var se=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"componentDidMount",value:function(){document.body.style.backgroundColor="#666"}},{key:"render",value:function(){return i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement("div",{style:{display:"inline-block",width:"600px"}},i.a.createElement("h1",{style:{color:"white"}},"Sploosh Kaboom Probability Calculator"),i.a.createElement("p",{style:{color:"white"}},"This page gives exact probabilities (no approximation) of hitting a squid in each cell, given the observation of hits, misses, and completed squid kills. Click on the map to cycle a cell between HIT and MISS. You can also set the number of squids completely killed in the drop-down menu at the bottom. You should set this to the value you see in the game for the number of squids killed. This will yield slightly more accurate probabilities. The highest probability location to play will be shown with a yellow outline. If you play perfectly according to picking the highlighted cell you will win in 20 or fewer shots \u224818.5% of the time.")),i.a.createElement(ie,null),i.a.createElement("span",{style:{color:"white"}},"Made by Peter Schmidt-Nielsen and CryZe (v0.0.17)"),i.a.createElement("br",null),i.a.createElement("span",{style:{color:"white"}},i.a.createElement("a",{href:"https://github.com/petersn/web-sploosh-kaboom"},"GitHub Repository")))}}]),a}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(se,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[16,1,2]]]);
//# sourceMappingURL=main.70cb1dc6.chunk.js.map